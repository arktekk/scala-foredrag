<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">

    <title>Scala</title>

    <meta name="apple-mobile-web-app-capable" content="yes"/>
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"/>

    <link href='http://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic' rel='stylesheet'
          type='text/css'>

    <link rel="stylesheet" href="reveal/css/main.css">
    <link rel="stylesheet" href="reveal/css/theme/default.css" id="theme">
    <link href="reveal/plugin/prettify/prettify.css" type="text/css" rel="stylesheet"/>
    <link href="reveal/css/code.css" type="text/css" rel="stylesheet"/>

    <script>
        // If the query includes 'print-pdf' we'll use the PDF print sheet
        document.write('<link rel="stylesheet" href="reveal/css/print/' + ( window.location.search.match(/print-pdf/gi) ? 'pdf' : 'paper' ) + '.css" type="text/css" media="print">');
    </script>

    <!--[if lt IE 9]>
    <script src="reveal/lib/js/html5shiv.js"></script>
    <![endif]-->
</head>

<body>

<div class="reveal">

    <!-- Used to fade in a background when a specific slide state is reached -->
    <div class="state-background"></div>

    <!-- Any section element inside of this container is displayed as a slide -->
    <div class="slides">
        <section>
        	<h1>Scala</h1>			
			<h3>Jon-Anders Teigen</h3>
			<h3><a href="http://arktekk.no">Arktekk</a></h3>
			<h3><a href="http://twitter.com/jteigen">@jteigen</a></h3>
        </section>
		
		<section>
			<h2>1995</h2>
			<img src="young.jpg"/>
		</section>
		
		<section>
			<pre style="color:white;background:black"><code>
Why.java:3: ';' expected
    System.out.println("whyyyy ?")
			</code></pre>
		</section>
		
		<section>
			<h2>2012</h2>
			<img src="old.jpg"/>
		</section>
		
		<section>
			<img src="scala.png" width="100%"/>
			<ul>
				<li>Martin Odersky</li>
				<li>1995 - Researched making Java functional</li>
				<li>2001 - Started Scala @ EPFL</li>
				<li>2003 - Released Scala</li>
				<li>2012 - Well adopted</li>
			</ul>
		</section>
		
		<section>
			<h2>Functional programming - 30s</h2>
			<ul>
				<li>Lambda Calculus, Lisp, ML, Haskell..</li>
				<li>Great for algorithms</li>
				<li>Compose Functions</li>
			</ul>			
		</section>
		
		<section>
			<h2>Object orientation - 60s</h2>
			<ul>
				<li>Simula, Smalltalk, C++, Java, Javascript, Ruby, Groovy.. Erlang?</li>
				<li>Great for certain models like GUI</li>
				<li>Inheritance, Message passing</li>
				<li>Gigantic Markedshare!</li>
			</ul>
		</section>
		
		<section>
			<h2>Object oriented *OR* Functional ?</h2>
		</section>
		
		<section>
			<h2>Object oriented *AND* Functional ?</h2>
			<img src="../PU/Winniethepooh.png">
		</section>		
	
		<section>
			<h2>Features ?</h2>
			<img src="../PU/sink.jpg">
		</section>
		
		<section>
			<h2>Features!</h2>
			<img src="../PU/dna.png">
		</section>
		
		<section>
			<img src="../PU/bob.jpg">
		</section>
		
		<section>
		 	<h2>variabler</h2>
			<pre class="prettyprint"><code>
var foo = 5
			</code></pre>
			<pre class="prettyprint"><code>
// eksplisitt typet
var foo:Int = 5
			</code></pre>
		</section>
		
		<section>
		<h2>values</h2>
		<pre class="prettyprint"><code>
val x = "Hello"
	</code></pre>
	<pre class="prettyprint"><code>
// eksplisitt typet
val x:String = "Hello"	
	</code></pre>
		</section>
				
		<section>
			<h2>Metoder</h2>
			<pre class="prettyprint"><code>
def foo(a:Int) = a + 5
			</code></pre>
			<pre class="prettyprint"><code>
def foo(a:Int):Int = {
  return a + 5
}			
			</code></pre>
		</section>
		
		<section>
			<h2>Nesting</h2>
			<pre class="prettyprint"><code>
val init = {
  def plus(a:Int, b:Int) = a + b
  val x = 5
  plus(x, 1)
}
			</code></pre>
		</section>
		
		<section>
			<h2>Lazy</h2>
			<pre class="prettyprint"><code>
lazy val init = {
  def fromDB(a:Int, b:Int) = ...
  val x = 5
  plus(x, 1)
}
			</code></pre>
		</section>
		
		<section>
			<h2>Equality</h2>
			<pre class="prettyprint"><code>
val a = new String("Hello")
val b = new String("Hello")

a == b // true (java equals)
a eq b // false (java ==)			
			</code></pre>
		</section>
		
		<section>
			<h2>operators ?</h2>
			<pre class="prettyprint"><code>
val a = BigDecimal("100.00")
val b = BigDecimal("25.00")

a * b
a - b
a / b
a + b
a &gt; b
a &lt; b
a &gt;= b
a &lt;= b
			</code></pre>
			<pre class="prettyprint fragment"><code>
"foo".charAt(0)

"foo" charAt 0			
			</code></pre>
		</section>
		
		<section>
			<pre class="prettyprint"><code>
import scala.util.parsing.combinator._

class JSON extends JavaTokenParsers {   

  def value : Parser[Any] = obj | arr | 
                            stringLiteral | 
                            floatingPointNumber | 
                            "null" | "true" | "false"

  def obj = "{"~repsep(member, ",")~"}"

  def arr = "["~repsep(value, ",")~"]"

  def member = stringLiteral~":"~value
}			
			</code></pre>
		</section>
		
		<section>
			<pre class="prettyprint"><code>
class Person {
  private final String name;
  private Integer age;

  public Person(String name, Integer age){
    this.name = name;
    this.age = age;
  }

  public String getName(){
    return name;
  }

  public Integer getAge(){
    return age;
  }

  public void setAge(Integer age){
    this.age = age;
  }

  public static Person create30(String name){
    return new Person(name, 30);
  }

  @Override
  public String toString(){
    return "["+name+","+age+"]";
  }
}
			</code></pre>
		</section>
		
		<section>
			<pre class="prettyprint"><code>
object Person {
  def create30(name:String) = new Person(name, 30)
}

class Person(val name: String, var age: Int){
  override def toString = "["+name+","+age+"]"
}			
			</code></pre>
		</section>
		
		<section>
			<h2>Unified Access Principle</h2>
			<pre class="prettyprint"><code>
class Person(private val _name: String,
             private var _age: Int) {

  def name = _name	

  def age = _age	

  def age_=(a:Int){
    _age = a	
  }
}			
			</code></pre>
		</section>
		
		<section>
			<pre class="prettyprint"><code>
val person = Person.create30("foo")

person.name // foo

person.age = 29
person.age // 29			
			</code></pre>
		</section>
		
		<section>
			<h2>Case classes</h2>
			<pre class="prettyprint"><code>
case class Person(name:String, age:Int)

val person = Person("Me", 31)
val updated = person.copy(age = person.age + 1)
			</code></pre>
		</section>
		
		<section>
			<h2>traits</h2>
			<pre class="prettyprint"><code>
trait Mult {
  def mult(a:Int, b:Int) = a * b
}

trait Add {
  def add(a:Int, b:Int) = a + b
}

object Calc extends Mult with Add

Calc.mult(4, Calc.add(1, 2))			
			</code></pre>
		</section>
		
		<section>
			<h2>stackable modifications</h2>
			<pre class="prettyprint"><code>
trait Rule {
  def convert(i:Int) = i.toString
}

trait Fizz extends Rule {
  override def convert(i:Int) =
    if(i % 3 == 0) "Fizz" else super.convert(i)
}

trait Buzz extends Rule {
  override def convert(i:Int) =
    if(i % 5 == 0) "Buzz" else super.convert(i)
}

trait FizzBuzz extends Rule {
  override def convert(i:Int) =
    if(i % 3 == 0 && i % 5 == 0) "FizzBuzz"
    else super.convert(i)
}			
			</code></pre>
		</section>
		
		<section>
			<pre class="prettyprint"><code>
// 1				
object FizzTest extends Rule with Fizz
(0 to 15).foreach(i => println(FizzTest.convert(i)))

// 2
object BuzzTest extends Rule with Buzz
(0 to 15).foreach(i => println(BuzzTest.convert(i)))

// 3
object FizzBuzzTest extends Rule with Fizz with Buzz with FizzBuzz
(0 to 15).foreach(i => println(FizzBuzzTest.convert(i)))

// 4
object BuzzFizzTest extends Rule with FizzBuzz with Fizz with Buzz
(0 to 15).foreach(i => println(BuzzFizzTest.convert(i)))			
			</code></pre>
		</section>
		
		<section>
			<img src="traits.png"/>
		</section>		
		
		<section>
			<h2>Functions</h2>
			<pre class="prettyprint"><code>
def adder(f:Int => Int) = f(5)

val plus1 = (i:Int) = i + 1
			</code></pre>
			<pre class="prettyprint fragment"><code>
adder(plus1) // 6
			</code></pre>
			<pre class="prettyprint fragment"><code>
adder(i => i + 1) // 6
			</code></pre>
			<pre class="prettyprint fragment"><code>
adder(_ + 1) // 6
			</code></pre>
			<pre class="prettyprint fragment"><code>
def plus1(i:Int) = i + 1

adder(plus1)			
			</code></pre>
		</section>
		
		<section>
			<h1>Collections</h1>
			<img src="collections.png"/>
		</section>
		
		<section>
			<h2>imperative vs functional</h2>
			<pre class="prettyprint"><code>
case class Person(name:String, age:Int)

val people = List(Person("kid-a", 10), 
                  Person("kid-b", 12), 
                  Person("mom", 42), 
                  Person("dad", 43))

var ages = new ListBuffer[Int]

for(person <- people){
  ages += person.age
}
			</code></pre>
			<pre class="prettyprint fragment"><code>
val ages = people.map(person => person.age)

// List(10, 12, 42, 43)
			</code></pre>
		</section>
		
		<section>
			<pre class="prettyprint"><code>
var kids = new ListBuffer[Person]

for(person <- people){
  if(person.age < 18)
    kids += person
}			
			</code></pre>
			<pre class="prettyprint fragment"><code>
val kids = people.filter(person => person.age < 18)

// List(Person("kid-a", 10), Person("kid-b", 12))
			</code></pre>
		</section>
		
		<section>
			<pre class="prettyprint"><code>
case class Owner(pets:List[String])
val owners = List(Owner(List("Dog", "Cat")), 
                  Owner(List("Fish")))

var pets = new ListBuffer[String]

for(owner <- owners){
  pets ++= owner.pets
}
			</code></pre>
			
			<pre class="prettyprint fragment"><code>
val pets = owners.flatMap(owner => owner.pets)

// List("Dog", "Cat", "Fish")
			</code></pre>
		</section>
		
		<section>		
		<pre class="prettyprint"><code>
var kids   = new ListBuffer[Person]
var adults = new ListBuffer[Person]

for(person <- people){
  if(person.age < 18)
    kids += person
  else
    adults += person
}
		</code></pre>
		
		<pre class="prettyprint fragment"><code>
val (kids, adults) = people.partition(person => person.age < 18)
		</code></pre>
		
		<pre class="prettyprint fragment"><code>
val (kids, adults) = people.partition(_.age < 18)
		</code></pre>
		</section>
		
		<section>
			<h2>Collections are functions</h2>
			<pre class="prettyprint"><code>
val list = List(1,2,3)
list(0) // of its indexes

val map = Map("A" -> 1, "B" -> 2)
map("A") // of its keys

val set = Set(1,2,3)
set(1) // true
			</code></pre>
		</section>		
		
		<section>
			<h2>Null<font color="red"> ♥</font> ?</h2>
			<pre class="prettyprint"><code>
import java.util.HashMap
val map = new HashMap[Int, String]
map.put(0, null)
...
map.get(0) // null
map.get(1) // null

if(map.containsKey(0)){
  return map.get(0)
}			
			</code></pre>
		</section>
		
		<section>
			<h2>Option = Some | None</h2>
			<pre class="prettyprint"><code>
val map = Map(0 -> "Hello", 1 -> "World")
map.get(0) // Some("Hello")
map.get(2) // None

map(0) // "Hello"
map(2) // java.util.NoSuchElementException			
			</code></pre>
		</section>
		
		<section>
			
			<pre class="prettyprint"><code>
val both = for {
  a <- map.get(0)
  b <- map.get(1)
} yield a + ":" + b

// both == Some("Hello:World")
			</code></pre>
			
			<pre class="prettyprint fragment"><code>
val both = for {
  a <- map.get(0)
  b <- map.get(2)
} yield a + ":" + b

// both == None
			</code></pre>
		</section>
		
		<section>
			<h2> pattern matching &amp; case classes</h2>
			<pre class="prettyprint"><code>
sealed trait Tree
case class Branch(left:Tree, right:Tree) extends Tree
case class Leaf(value:Int) extends Tree

def sum(tree:Tree):Int = tree match {
  case Branch(left, right) => sum(left) + sum(right)
  case Leaf(value)         => value
}

val tree = Branch(
    Branch(Leaf(1), Leaf(2)),
    Branch(Leaf(3), Leaf(4)))

sum(tree)			
			</code></pre>
		</section>
		
		<section>
			<pre class="prettyprint"><code>
val Email = """(.+)@(.+)\.(.+)""".r

"jon-anders.teigen@arktekk.no" match {

  case Email(name, domain, tld) => 
    Map("name" -> name, "domain" -> domain, "tld" -> tld)

  case email => 
    Map("error" -> ("cannot decompose email " + email))
}
			</code></pre>
			<pre class="prettyprint fragment"><code>
val Email(name, domain, tld) = "jon-anders.teigen@arktekk.no"
			</code></pre>
		</section>
		
		<section>
			<h2>Actors</h2>
			<pre class="prettyprint"><code>
class MyActor extends Actor {
  def receive = {
    case "hello" => 
      // do stuff
    case "world" =>
      // do other stuff
  }
}

myActor ! "hello"
			</code></pre>
		</section>
		
		<section>
			<h2>Unfiltered</h2>
			<pre class="prettyprint"><code>
class Demo extends Plan {				
  def intent = {
    case GET(Path("/")) => 
      Ok ~> ResponseString("Hello World")
    
    case GET(Path(Seg("product", id))) =>
      Ok ~> ResponseString("Product #" + id)
  }
}
			</code></pre>
		</section>
		
		<section>
			<h2>Type classes (ad-hoc polymorphism)</h2>
			<pre class="prettyprint"><code>
trait Add[A] {
  def zero:A
  def add(a1:A, a2:A):A 
}

def total[A](as:List[A])(implicit a:Add[A]) = 
  as.foldLeft(a.zero)(a.add)
			</code></pre>
			<pre class="prettyprint fragment"><code>
implicit object addInt extends Add[Int]{
  def zero = 0
  def add(a1:Int, a2:Int) = a1 + a2 
}				
total(List(1,2,3)) // 6
total(List[Int]()) // 0
			</code></pre>
			<pre class="prettyprint fragment"><code>
implicit def addList[A] = new Add[List[A]]{
  def zero = Nil
  def add(a1:List[A], a2:List[A]) = a1 ::: a2 
}
total(List(List("hello"), List("world")))
// List(hello, world)
			</code></pre>
		</section>
		
		<section>
			<h2>implicit conversions</h2>
			<pre class="prettyprint"><code>
implicit class Total[A](val as:List[A]) extends AnyVal { 
  def total(implicit a:Add[A]) = as.foldLeft(a.zero)(a.add) 
}

List(1,2,3).total // 6
			</code></pre>
		</section>
		
		<section>
			<h2>STM</h2>
			<pre class="prettyprint"><code>
import scala.concurrent.stm._

val x = Ref(0)

atomic{ implicit tx =>
  val i = x() // read
  x() = i + 1 // write	
}			
			</code></pre>
		</section>
		
		<section>
			<h1>?</h1>
		</section>
    </div>

    <!-- The navigational controls UI -->
    <aside class="controls">
        <a class="left" href="#">&#x25C4;</a>
        <a class="right" href="#">&#x25BA;</a>
        <a class="up" href="#">&#x25B2;</a>
        <a class="down" href="#">&#x25BC;</a>
    </aside>

    <!-- Presentation progress bar -->
    <div class="progress"><span></span></div>

</div>

<script src="reveal/lib/js/head.min.js"></script>
<script src="reveal/js/reveal.min.js"></script>

<script>

    // Full list of configuration options available here:
    // https://github.com/hakimel/reveal.js#configuration
    Reveal.initialize({
        controls:true,
        progress:true,
        history:true,

        theme:Reveal.getQueryHash().theme || 'default', // available themes are in /css/theme
        transition:Reveal.getQueryHash().transition || 'default', // default/cube/page/concave/linear(2d)

        // Optional libraries used to extend on reveal.js
        dependencies:[
            { src:'reveal/plugin/prettify/prettify.js', async:true, callback:function () {
                prettyPrint();
            } },
            { src:'reveal/lib/js/classList.js', condition:function () {
                return !document.body.classList;
            } },
            { src:'reveal/lib/js/showdown.js', condition:function () {
                return !!document.querySelector('[data-markdown]');
            } },
            { src:'reveal/lib/js/data-markdown.js', condition:function () {
                return !!document.querySelector('[data-markdown]');
            } },
            { src:'reveal//socket.io/socket.io.js', async:true, condition:function () {
                return window.location.host === 'localhost:1947';
            } },
            { src:'reveal/plugin/speakernotes/client.js', async:true, condition:function () {
                return window.location.host === 'localhost:1947';
            } }
        ]
    });

</script>

</body>
</html>